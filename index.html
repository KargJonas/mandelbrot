<!DOCTYPE html><meta content="width=device-width,initial-scale=1"name=viewport><title>Mandelbrot</title><style>body{margin:0;overflow:hidden;touch-action:none;background-color:#000}canvas{position:fixed}h1{position:fixed;color:#fff;font-family:sans-serif;bottom:0;margin:0 0 3px;font-size:1.5em;text-align:center;width:100vw;opacity:.4;user-select:none}div{position:fixed;top:0;left:5px;opacity:.6}input{width:200px}p{color:#fff;font-size:1.5em;font-family:sans-serif;margin:0}</style><canvas></canvas><h1>Scroll to zoom, click and drag to move around.</h1><div><p>Iterations</p><input max=30 min=1 step=1 type=range value=7></div><script>let P=document.querySelector("input"),n=document.querySelector("canvas"),G=n.getContext("webgl")||n.getContext("experimental-webgl"),S=G.createProgram(),V=`attribute vec2 p;void main(){gl_Position=vec4(p,0,1);}`,F=`precision highp float;uniform vec2 r;uniform vec2 m;uniform float o;uniform int s;vec2 S(vec2 a){return vec2(a.x*a.x-a.y*a.y,2.*a.x*a.y);}vec2 z(vec2 c){vec2 C=vec2(0.,0.);for(int i=0;i<900;i++){if(i>s)break;C=S(C)+c;}return C;}vec3 g(vec2 p){float x=log(length(z(p)));return vec3(1.-abs(sin(x)),1.-abs(sin(x+.4)),1.-abs(sin(x+.8)));}void main(){vec2 p=gl_FragCoord.xy/r.y;p.x-=(r.x/r.y)/2.;p.y-=.5;vec3 c=g(p/o+m);gl_FragColor=vec4(c,1.);}`;let z=.3,w,h,x=y=j=k=d=0,a=addEventListener,g=(a,b)=>G.getUniformLocation(a,b),C=()=>{w=innerWidth;h=innerHeight;n.width=w;n.height=h;G.uniform2f(g(S,"r"),w,h);G.uniform2f(g(S,"m"),x,y);G.uniform1f(g(S,"o"),z);G.uniform1i(g(S,"s"),Math.pow(P.value,2))},v=[-1,-1,-1,1,1,-1,1,1],U=()=>{G.drawArrays(5,0,4);requestAnimationFrame(U)},D=(T,O)=>{let a=G.createShader(T);G.shaderSource(a,O);G.compileShader(a);G.attachShader(S,a)};a("pointerdown",e=>{d=1;j=1-e.clientX/w;k=e.clientY/h});a("pointerup",()=>d=0);a("pointermove",e=>{if(!d)return;C();let cx=1-e.clientX/w,cy=e.clientY/h,dx=cx-j,dy=cy-k;x+=dx/z;y+=dy/z;j=cx;k=cy});a("wheel",e=>{z*=e.deltaY<0?.95:1.05;C();});a("resize",()=>{C();G.viewport(0,0,w,h)});P.addEventListener("change",C);D(35633,V);D(35632,F);G.linkProgram(S);G.useProgram(S);C();G.bindBuffer(34962,G.createBuffer());G.bufferData(34962,new Float32Array(v),35044);G.vertexAttribPointer(0,2,5126,0,0,0);G.enableVertexAttribArray(0);G.viewport(0,0,w,h);U();</script>